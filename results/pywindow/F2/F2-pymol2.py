import pymol
from pymol import cmd, stored

pymol.finish_launching(["pymol", "-q"])

cmd.load("../../../data/F2.pdb", quiet=False)
cmd.load("F2.pywindow.pdb", quiet=False)

stored.b = []
cmd.iterate("(resn COM+W1+W2+W3+W4+W5+W6+W7+W8+W9+W10+W11+W12+W13+W14+W15+W16+W17+W18+W19+W20+W21+W22+W23+W24+W25+W26+W27)", "stored.b.append(b)")
cmd.alter("resn COM", "vdw=stored.b[0]")
cmd.alter("resn W1", "vdw=stored.b[1]")
cmd.alter("resn W2", "vdw=stored.b[2]")
cmd.alter("resn W3", "vdw=stored.b[3]")
cmd.alter("resn W4", "vdw=stored.b[4]")
cmd.alter("resn W5", "vdw=stored.b[5]")
cmd.alter("resn W6", "vdw=stored.b[6]")
cmd.alter("resn W7", "vdw=stored.b[7]")
cmd.alter("resn W8", "vdw=stored.b[8]")
cmd.alter("resn W9", "vdw=stored.b[9]")
cmd.alter("resn W10", "vdw=stored.b[10]")
cmd.alter("resn W11", "vdw=stored.b[11]")
cmd.alter("resn W12", "vdw=stored.b[12]")
cmd.alter("resn W13", "vdw=stored.b[13]")
cmd.alter("resn W14", "vdw=stored.b[14]")
cmd.alter("resn W15", "vdw=stored.b[15]")
cmd.alter("resn W16", "vdw=stored.b[16]")
cmd.alter("resn W17", "vdw=stored.b[17]")
cmd.alter("resn W18", "vdw=stored.b[18]")
cmd.alter("resn W19", "vdw=stored.b[19]")
cmd.alter("resn W20", "vdw=stored.b[20]")
cmd.alter("resn W21", "vdw=stored.b[21]")
cmd.alter("resn W22", "vdw=stored.b[22]")
cmd.alter("resn W23", "vdw=stored.b[23]")
cmd.alter("resn W24", "vdw=stored.b[24]")
cmd.alter("resn W25", "vdw=stored.b[25]")
cmd.alter("resn W26", "vdw=stored.b[26]")
cmd.alter("resn W27", "vdw=stored.b[27]")
cmd.rebuild()

cmd.spectrum("b", "blue_white_red", "F2.pywindow", [0, max(stored.b)])
cmd.ramp_new("radius", "F2.pywindow", [0, max(stored.b)], ["blue", "white", "red"])
cmd.orient()

cmd.save("F2.pse")
